# Kakao JavaScript Style Guide

Kakao Javascript 개발자를 위한 스타일 가이드

## 목차
  1. [목적](#목적)
  1. [스타일 가이드](#스타일-가이드)
        1. [ES3](./es3/README.md)
        1. [ES2015+](./es2015/README.md)
        1. [TypeScript](./typescript/README.md)
        1. [주석](./comment/README.md)
  1. [설치 및 초기화](#설치-및-초기화)
  1. [사용법](#사용법)
  1. [라이브러리 설정](#라이브러리-설정)
        1. [React](#React)
        1. [Vue](#Vue)
        1. [외부 라이브러리](#외부-라이브러리)
  1. [설정](#설정)
        1. [실행 스크립트](#실행-스크립트-설정)
        1. [Local 에서 개발할 때의 규칙](#local-에서-개발할-때의-예외-규칙-적용)
        1. [외부 라이브러리](#외부-라이브러리-설정)
        1. [리액트](#리액트react-설정)
  1. [추가 설정](#추가-설정)
        1. [precommit](#precommit)
        1. [IDE 설정](#ide-설정)
  1. [규칙 및 파일 제외](#규칙-및-파일-제외)
        1. [규칙 제외](#규칙-제외)
        1. [파일 제외](#파일-제외)
  1. [규칙 및 문서 수정](#규칙-및-문서-수정)


## 목적

Kakao 개발자 간의 코딩 스타일 통일, 문법, 논리적 문제 예방, 더 좋은 방법의 제안을 위한 스타일 가이드입니다.  
더 자세한 소개는 [소개 페이지](./INTRODUCE.md)를 참고하세요.

**[⬆ 처음으로](#kakao-javascript-style-guide)**

## 스타일 가이드
  * [ES3 Style Guide](./es3/README.md)
  * [ES2015+ Style Guide](./es2015/README.md)
  * [TypeScript Style Guide](./typescript/README.md)
  * [주석 Style Guide](./comment/README.md)  
  
**[⬆ 처음으로](#kakao-javascript-style-guide)**

## 설치 및 초기화
#### 필요조건
- Node.js (>=6.14)
- ESlint (>=5)

### 1. 사내 npm 설정

프로젝트의 루트에 .npmrc 파일을 생성한 뒤 아래 코드를 추가합니다. 
```
registry=https://npm.daumkakao.io
```
> 이미 설정되어 있는 경우 스킵합니다.

### 2. 설치
* 공통 (ES3)
    ```
    $ npm i -D eslint eslint-plugin-jsdoc @kakao/eslint-config-styleguide
    ```
* ES2015+  
    공통(ES3) 설치 후 추가 설치
    ```
    $ npm i -D eslint-plugin-import babel-eslint
    ```
* TypeScript  
    공통(ES3) 설치 후 추가 설치
    ``` 
    $ npm i -D typescript (이미 설치되어 있을 경우 스킵) 
    $ npm i -D eslint-plugin-import @typescript-eslint/eslint-plugin @typescript-eslint/parser
    ```

### 3. 초기화 
```
$ ./node_modules/\@kakao/eslint-config-styleguide/bin/styleguide.js --init

혹은

$ npx kakao-styleguide --init
```

**[⬆ 처음으로](#kakao-javascript-style-guide)**

## 사용법
```
$ ./node_modules/eslint/bin/eslint 파일 또는 디렉터리

혹은

$ npx eslint 파일 또는 디렉터리
```

**[⬆ 처음으로](#kakao-javascript-style-guide)**

## 라이브러리 설정

### React
React를 사용하는 경우 아래와 같이 설정합니다.
1. 플러그인 설치
    ```
    $ npm install eslint-plugin-react --save-dev
    ```
2. 플러그인에 대한 설정 추가.
    * .eslintrc
      ```js
      {
        // 플러그인 추가
        "plugins": ["react"],

        // React 규칙 설정 추가
        "extends": [
          // ...
          "plugin:react/recommended"
          ],

        // jsx 옵션 추가  
        "parserOptions": {
          "ecmaFeatures": {
            "jsx": true
          }
        }
      }
      ```
3. .jsx, .tsx 확장자를 사용하는 경우 아래 설정 추가
    * package.json
      ```json
      {
        "lint-staged": {
          "src/**/*.{js,ts,jsx,tsx}": [
            "eslint --fix",
            "git add"
          ]
        }
      }
      ```

* [ESLint React 플러그인 참고](https://github.com/yannickcr/eslint-plugin-react)


### Vue
Vue를 사용하는 경우 아래와 같이 설정합니다.
1. 플러그인 설치
    ```
    $ npm install eslint-plugin-vue --save-dev
    ```
2. 플러그인에 대한 설정 추가
   * .eslintrc
    ```js
    {
      // 플러그인 추가
      "plugins": ["vue"],

       // Vue 규칙 설정 추가              
      "extends": ["plugin:vue/recommended"],
    }
    ```
3. .vue 확장자에 대한 설정 추가
    * package.json
      ```json
      {
        "lint-staged": {
          "src/**/*.{js,vue}": [
            "eslint --fix",
            "git add"
          ]
        }
      }
      ```
* [ESLint Vue 플러그인 참고](https://eslint.vuejs.org/user-guide/)

### 외부 라이브러리 설정
외부 라이브러리 사용시, 글로벌 변수를 설정합니다. 

* .eslintrc.json 설정
    ```js
    {
      "globals": {
        "$": true, // ex) jQuery 사용시
      }
    }
    ```

**[⬆ 처음으로](#kakao-javascript-style-guide)**

## 설정
`styleguide --init`를 실행한 후 자동으로 `.eslintrc.json` 또는 `.eslintrc.js` 파일이 생성됩니다.  
이 파일을 수정하면 설정을 변경할 수 있습니다.  
자세한 설정 내용은 [eslint 설정](https://eslint.org/docs/user-guide/configuring)에서 볼 수 있습니다.

### 실행 스크립트 설정
1. `package.json` scripts 에 linter를 실행시킬 명령어를 설정.
    ```json
    {
      "scripts": {
        "lint": "eslint 파일또는디렉터리"
      }
    }
    ```
2. 실행
    ```
    $ npm run lint
    ```

### Local 에서 개발할 때의 예외 규칙 적용
debugger를 허용하지 않는 `no-debugger`규칙 등 Local에서 개발중에만 완화가 필요한 규칙이 있습니다.  
환경변수로 `USE_LOCAL_LINT_RULE=true`를 사용하면 아래와 같이 완화된 규칙이 적용됩니다.

1. no-debugger: error -> warning  

환경변수 등록은 몇 가지 방법이 있는데, 아래는 PC에서 임시로 지정하는 방법입니다. 
```shell
export USE_LOCAL_LINT_RULE=true
```

`package.json` scripts에 아래와 같이 설정하는 방법도 있습니다.
```json
{
  "scripts": {
    "lint:local": "USE_LOCAL_LINT_RULE=true eslint 파일또는디렉터리"
  }
}
```

**[⬆ 처음으로](#kakao-javascript-style-guide)**

## 추가 설정

### precommit
  초기화 중 precommit 설정을 하면 package.json 파일에 아래와 같이 lint-staged, husky 설정이 추가됩니다.  
  ```js
    ...
    "lint-staged": {
      "src/**/*.{js,ts}": [
        "eslint --fix",
        "git add"
      ]
    },
    "husky": {
      "hooks": {
        "pre-commit": "lint-staged"
      }
    }
    ...
  ```
  만약 검사하고자 하는 파일이 src 폴더 아래에 있지 않다면 `"src/**/*.{js,ts}"` 부분을 수정해야 합니다.  
  이후 커밋을 할 경우 자동으로 포맷터가 동작합니다. 만약 자동으로 수정할 수 없는 오류가 있다면 메세지와 함께 commit이 중단됩니다.

### IDE 설정
 
#### Sublime text3
  * [SublimeLinter3](http://www.sublimelinter.com/en/stable/) 설치.
  * [SublimeLinter-eslint](https://github.com/SublimeLinter/SublimeLinter-eslint) 참고.

#### IntelliJ
  * Languages & Frameworks > JavaScript > Code Quality Tools > ESLint에서 Enable 체크.

#### etc
  * [추가 IDE설정](https://eslint.org/docs/user-guide/integrations) 참고.


**[⬆ 처음으로](#kakao-javascript-style-guide)**

## 규칙 및 파일 제외

### 규칙 제외

 * 한줄 규칙 제외
    ```js
    // eslint-disable-next-line no-alert
    alert('foo');
    ```

 * 여러줄 규칙 제외 
    ```js
    /* eslint-disable no-alert, no-console */
    
    alert('foo');
    console.log('bar');
    
    /* eslint-enable no-alert, no-console */
    ```

**[⬆ 처음으로](#kakao-javascript-style-guide)**

### 파일 제외

eslint 실행이 필요하지 않은 폴더나 파일이 있는 경우 `.eslintignore` 파일을 생성합니다.  
파일 내부에 실행시키지 않을 파일 경로 혹은 와일드카드를 입력합니다.
  * 예시)
    ```
    **/lib/
    ```
    > 모든 /lib으로 되어 있는 폴더에는 eslint를 실행시키지 않습니다.

**[⬆ 처음으로](#kakao-javascript-style-guide)**

## 규칙 및 문서 수정
ES6, ES2015+, Typescript, 주석 문서 및 린트 설정의 수정, 추가는 [문서 & lintrc 생성기](./lib/generator/README.md)를 참고하세요.

**[⬆ 처음으로](#kakao-javascript-style-guide)**
